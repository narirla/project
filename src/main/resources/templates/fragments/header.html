<!-- header.html -->
<header th:fragment="header"
        th:if="${session.loginRole} != 'SELLER'"
        id="BUYER_HEADER" data-frag="BUYER-HEADER">
  <div class="header-inner">
    <!-- 최상단 로그인/회원가입 or 사용자 정보 -->
    <div class="header-top-bar">
      <div class="user-links">
        <!-- 비로그인 상태 -->
        <th:block th:if="${not #authorization.expression('isAuthenticated()')}">
          <a th:href="@{/login}">로그인</a>
          <a th:href="@{/members/join}">회원가입</a>
        </th:block>

        <!-- 로그인 상태 -->
        <th:block th:if="${#authorization.expression('isAuthenticated()')}">
          <div class="user-logged-in">
            <form th:action="@{/login/logout}" method="post" class="logout-form">
              <input type="hidden" sec:csrf/>
              <button type="submit" class="logout-button" aria-label="로그아웃">로그아웃</button>
            </form>
            <a th:href="@{/notifications}" class="notification-link" aria-label="알림">
              <i class="fa fa-bell" aria-hidden="true"></i> <span>알림</span>
            </a>
          </div>
        </th:block>
      </div>
    </div>

    <!-- 로고, 검색창, 사용자 메뉴 -->
    <div class="header-main">
      <a th:href="@{/?role=BUYER}" class="logo">
        <img th:src="@{/img/msi.png}" alt="MO:SI 아이콘" style="width:64px; height:64px; margin-left:23px;">
        <span>MO:SI</span>
      </a>

      <div class="search-box">
        <input type="text" id="search-input-buyer" placeholder="검색어를 입력하세요." aria-label="검색어 입력창" autocomplete="off">
        <button id="search-button-buyer" type="submit" aria-label="검색"><i class="fa fa-search" aria-hidden="true"></i></button>

        <div id="search-dropdown-buyer" class="search-dropdown">
          <div id="search-list-buyer"></div>
        </div>
      </div>

      <div class="user-menu">
        <a th:href="@{/wishlist}" aria-label="관심상품">
          <i class="fas fa-heart" aria-hidden="true"></i><span>관심상품</span>
        </a>
        <a th:href="@{/mypage/buyer}" aria-label="내 정보">
          <i class="fas fa-user" aria-hidden="true"></i><span>내 정보</span>
        </a>
        <a th:href="@{/cart}" aria-label="장바구니" class="cart-link">
          <i class="fas fa-shopping-bag" aria-hidden="true"></i><span>장바구니</span>
          <span class="cart-badge" id="cart-count" style="display: none;">0</span>
        </a>
      </div>
    </div>

    <!-- 내비게이션 메뉴 -->
    <nav class="header-nav">
      <div class="dropdown-wrapper">
        <ul class="menu">
          <!-- 모든 메뉴 버튼 -->
          <li class="menu-item dropdown"><a href="#" class="menuButton">전체메뉴</a></li>
          <li class="menu-item dropdown"><a href="#" class="menuButton">테마여행</a></li>
          <li class="menu-item dropdown"><a href="#" class="menuButton">커뮤니티</a></li>
          <li class="menu-item dropdown"><a href="#" class="menuButton">항공/호텔</a></li>
          <li class="menu-item dropdown"><a href="#" class="menuButton">관광 정보</a></li>
        </ul>

        <!-- ✅ 모든 메뉴가 여는 하나의 드롭다운 -->
        <div class="dropdown-menu">
          <!-- 테마여행 -->
          <div class="dropdown-section">
            <h4>테마여행</h4>
            <ul>
              <li th:classappend="${selectedCategory} == 'all' ? 'active'">
                <a th:href="@{/product/list(category='all')}">전체</a>
              </li>
              <li th:classappend="${selectedCategory} == 'area' ? 'active'">
                <a th:href="@{/product/list(category='area')}">지역</a>
              </li>
              <li th:classappend="${selectedCategory} == 'pet' ? 'active'">
                <a th:href="@{/product/list(category='pet')}">반려동물</a>
              </li>
              <li th:classappend="${selectedCategory} == 'restaurant' ? 'active'">
                <a th:href="@{/product/list(category='restaurant')}">맛집</a>
              </li>
              <li th:classappend="${selectedCategory} == 'culture_history' ? 'active'">
                <a th:href="@{/product/list(category='culture_history')}">문화/역사</a>
              </li>
              <li th:classappend="${selectedCategory} == 'season_nature' ? 'active'">
                <a th:href="@{/product/list(category='season_nature')}">계절/자연</a>
              </li>
              <li th:classappend="${selectedCategory} == 'silver_disables' ? 'active'">
                <a th:href="@{/product/list(category='silver_disables')}">실버/교통약자</a>
              </li>
            </ul>
          </div>
          <!-- 커뮤니티 -->
          <div class="dropdown-section">
            <h4>커뮤니티</h4>
            <ul>
              <li><a th:href="@{/bbs}">리뷰</a></li>
              <li><a th:href="@{/bbs/community}">자유 게시판</a></li>
            </ul>
          </div>
          <!-- 항공 / 호텔 -->
          <div class="dropdown-section">
            <h4>항공/호텔</h4>
            <ul>
              <li><a href="#">항공</a></li>
              <li><a href="#">호텔</a></li>
            </ul>
          </div>
          <!-- 관광 정보 -->
          <div class="dropdown-section">
            <h4>관광 정보</h4>
            <ul>
              <li><a th:href="@{/information/restaurant}">맛집</a></li>
              <li><a th:href="@{/information/accessibility}">교통약자 편의시설</a></li>
            </ul>
          </div>
        </div>
      </div>
    </nav>


  </div>
  <script th:src="@{/js/Search.js}"></script>
</header>


