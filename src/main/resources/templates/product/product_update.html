<!DOCTYPE html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>MO:SI 판매자 마이페이지</title>
  <link rel="stylesheet" th:href="@{/css/layout.css}">
  <link rel="stylesheet" th:href="@{/css/common.css}">
  <link rel="stylesheet" th:href="@{/css/sellerpage/sellerMypageHome.css}">
  <link rel="stylesheet" th:href="@{/css/product/product_update.css}" />
  <link rel="stylesheet" th:href="@{https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css}">
  <link rel="stylesheet" th:href="@{https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css}" />
</head>

<body>
<div class="layout-wrapper">
  <header th:replace="~{fragments/sellerHeader :: sellerHeader}"></header>
  <div class="page-container">
    <main class="mypage-container">
      <!-- 사이드 바 분리 -->
      <div th:replace="~{fragments/sellerSidebar :: sellerSidebar(activePath=${activePath})}"></div>

      <section class="content">
        <div class="product-registration">
          <h2>상품 수정</h2>
          <hr>
          <div class="product-registration-main">
            <div class="resgistratrion-title">상품 기본 정보 수정</div>
            <div class="resgistration-content">
              <form id="productForm" class="post-form" th:object="${productUploadForm}" th:action="@{/product/edit/{id}(id=${productUploadForm.product.productId})}" method="post" enctype="multipart/form-data">
                <input type="hidden" th:field="*{product.productId}" th:if="${productUploadForm.product.productId != null}">
                <input type="hidden" name="deleteImageIds" id="deleteImageIds" value="" />
                <!-- 카테고리 -->
                <div class="form-group">
                  <label><b>*</b>&nbsp카테고리</label>
                  <div>
                    <select th:field="*{product.category}">
                      <option value="select">카테고리 선택</option>
                      <option value="area">지역</option>
                      <option value="pet">반려동물</option>
                      <option value="restaurant">맛집</option>
                      <option value="culture_history">문화/역사</option>
                      <option value="season_nature">계절/자연</option>
                      <option value="silver_disables">실버/교통약자</option>
                    </select>
                  </div>
                </div>
                <!-- 상품명 -->
                <div class="form-group">
                  <label><b>*</b>&nbsp상품명</label>
                  <div><input class="pname" type="text" th:field="*{product.title}" maxlength="60" placeholder="상품명을 입력해주세요.">
                  </div>
                </div>
                <!-- 가이드 동반 여부 -->
                <div class="form-group">
                  <label><b>*</b>&nbsp가이드 동반 여부</label>
                  <div>
                    <input type="radio" th:field="*{product.guideYn}" value="N" required>
                    <div>미포함</div>
                    <input type="radio" th:field="*{product.guideYn}" value="Y">
                    <div>포함</div>
                  </div>
                </div>
                <!-- 정상 상품 가격 -->
                <div class="form-group price-group">
                  <label><b>*</b>&nbsp정상 상품 가격</label>
                  <div>
                    <input class="price pname" type="number" th:field="*{product.normalPrice}" placeholder="기본 정보 가격" min="0"
                           required>
                    <div class="tag">원</div>
                    <input class="price pname" type="number" th:field="*{product.guidePrice}" placeholder="가이드 동반 가격" min="0"
                           required>
                    <div class="tag">원</div>
                  </div>
                </div>
                <!-- 판매 상품 가격 -->
                <div class="form-group price-group">
                  <label><b>*</b>&nbsp판매 상품 가격</label>
                  <div>
                    <input class="price pname" type="number" th:field="*{product.salesPrice}" placeholder="기본 정보 가격" min="0" required>
                    <div>원</div>
                    <input class="price pname" type="number" th:field="*{product.salesGuidePrice}" placeholder="가이드 동반 가격" min="0"
                           required>
                    <div>원</div>
                  </div>
                </div>
                <!-- 소요 기간 -->
                <div class="form-group duration-group">
                  <label><b>*</b>&nbsp소요 시간 or 기간</label>
                  <div>
                    <input class="span" type="number" th:field="*{product.totalDay}" placeholder="일" min="0" required>
                    <div>일</div>
                    <input class="span" type="number" th:field="*{product.totalTime}" placeholder="시간" min="0" required>
                    <div>시간</div>
                  </div>
                </div>
                <!-- 최소 경비 -->
                <div class="form-group">
                  <label><b>*</b>&nbsp최소 여행 경비 (1인당)</label>
                  <div>
                    <input class="price" type="number" th:field="*{product.reqMoney}" min="0" required>
                    <div>원</div>
                  </div>
                </div>
                <!-- 숙박 포함 여부 -->
                <div class="form-group">
                  <label>&nbsp&nbsp&nbsp숙박 포함 여부</label>
                  <div>
                    <input type="radio" th:field="*{product.sleepInfo}" value="N" checked requried>
                    <div>미포함</div>
                    <input type="radio" th:field="*{product.sleepInfo}" value="Y">
                    <div>포함</div>
                  </div>
                </div>
                <!-- 교통 -->
                <div class="form-group">
                  <label>&nbsp&nbsp&nbsp교통 정보</label>
                  <div><input class="transport" type="text" th:field="*{product.transportInfo}" maxlength="15"
                              placeholder="ex) 도보로 이동"></div>
                </div>
                <!-- 식사 일정 여부 -->
                <div class="form-group">
                  <label>&nbsp&nbsp&nbsp식사 일정 여부</label>
                  <div>
                    <input type="radio" th:field="*{product.foodInfo}" value="N" checked requried>
                    <div>미포함</div>
                    <input type="radio" th:field="*{product.foodInfo}" value="Y">
                    <div>포함</div>
                  </div>
                </div>
                <!-- 추천 인원 -->
                <div class="form-group">
                  <label>&nbsp&nbsp&nbsp추천 인원</label>
                  <div><input class="recommendation" type="text" th:field="*{product.reqPeople}" maxlength="15"
                              placeholder="ex) 2~3명, 4명 이상 등"></div>
                </div>
                <!-- 추천 대상 -->
                <div class="form-group">
                  <label>&nbsp&nbsp&nbsp추천 대상</label>
                  <div><input class="recommendation" type="text" th:field="*{product.target}" maxlength="15"
                              placeholder="ex) 4, 50대 중년 커플"></div>
                </div>
                <!-- 추천 준비물 -->
                <div class="form-group">
                  <label>&nbsp&nbsp&nbsp추천 준비물</label>
                  <div><input class="pname" type="text" th:field="*{product.stucks}" maxlength="60" placeholder="물, 양산, 걸옷 등">
                  </div>
                </div>
                <!-- 이미지 업로드 영역 -->
                <div class="form-group img">
                  <label>&nbsp&nbsp&nbsp상품 이미지 등록</label>
                  <div class="image-upload-container">
                    <div class="image-upload-single">
                      <div class="upload-box">
                        <input id="productImage" type="file" name="uploadImages" multiple style="display:none;">
                        <i class="fa fa-cloud-upload-alt" style=""></i>
                        <p style="text-align:center; color:#717171; font-size:14px;">클릭하거나 파일을 드래그하여 <br>이미지 업로드</p>
                        <img class="image-preview" src="" alt="미리보기 이미지"
                             style="display:none; max-width: 100%; border-radius: 8px; margin-top: 10px;" />
                      </div>
                    </div>
                    <!-- 파일명 리스트 영역 -->
                    <div id="imageNameList" class="image-name-list">
                      <!-- 기존 이미지들 표시 -->
                      <div th:each="image : ${productUploadForm.existingImages}"
                           th:if="${productUploadForm.existingImages != null and !productUploadForm.existingImages.empty}"
                           class="image-name-item existing-image"
                           th:attr="data-image-id=${image.imageId},data-image-name=${image.fileName}">
                        <span th:text="${image.fileName}">기존 이미지명</span>
                        <button type="button" class="remove-image" th:attr="data-image-id=${image.imageId}">×</button>
                      </div>
                    </div>
                  </div>
                </div>
                <!-- 기본 설명 -->
                <div class="form-group pdescription">
                  <label><b>*</b>&nbsp상품 기본 설명</label>
                  <div><textarea th:field="*{product.description}" placeholder="구매자에게 노출될 상품에 대한 기본 설명"></textarea></div>
                </div>
                <!-- 상세 설명 -->
                <div class="form-group pdescription">
                  <label><b>*</b>&nbsp상품 상세 설명</label>
                  <div><textarea th:field="*{product.detail}" placeholder="판매될 여행 상품에 대한 자세한 설명"></textarea></div>
                </div>
                <!-- PDF 파일 첨부 -->
                <div class="form-group">
                  <label><b>*</b>&nbsp판매 파일 첨부</label>
                  <div>
                    <!-- 기존 파일 정보 표시 -->
                    <div th:if="${productUploadForm.product.fileName != null}" class="current-file-info">
                      <span>현재 파일: </span> 
                      <a th:href="@{/product/download/product/{id}(id=${productUploadForm.product.productId})}"
                         th:text="${productUploadForm.product.fileName}"
                         class="current-file-link">기존 파일명</a>
                      <span class="file-size">
                          (<span th:text="${#numbers.formatDecimal(productUploadForm.product.fileSize / 1024, 0, 0)}">0</span> KB)
                        </span>
                    </div>
                    <!-- 새 파일 업로드 -->
                    <input type="file" name="documentFile">
                  </div>
                </div>
                <!-- 가격 정보 상세 -->
                <div class="form-group price">
                  <label><b>*</b>&nbsp가격 정보 상세 기입</label>
                  <div class="price-info">
                    <div class="price-box">
                      <div class="price-info-basic">기본</div>
                      <textarea th:field="*{product.priceDetail}" placeholder="ex) 기본 여행코스 PDF..."></textarea>
                    </div>
                    <div class="price-box">
                      <div class="price-info-guided">가이드 동반</div>
                      <textarea th:field="*{product.gpriceDetail}" placeholder="ex) 예약 필수..."></textarea>
                    </div>
                  </div>
                </div>
                <div class="form-group submit-btn">
                  <button type="submit" id="updateBtn">수정</button>

                  <button type="button" id="tempSaveBtn">임시저장</button>

                  <button type="button" onclick="history.back()">취소</button>
                </div>
              </form>
            </div>
          </div>
        </div>
      </section>
    </main>
  </div>
  <footer th:replace="~{fragments/footer :: footer}"></footer>
</div>
<script th:src="@{/js/product/product_update.js}"></script>
<script th:src="@{/js/sellerpage/sellerMypageHome.js}"></script>
<script th:src="@{/js/layout.js}"></script>
<script th:src="@{/js/product/product_validation.js}"></script>
</body>

</html>